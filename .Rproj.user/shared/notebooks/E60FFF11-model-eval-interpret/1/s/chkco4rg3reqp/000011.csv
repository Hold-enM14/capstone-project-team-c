"0","main_data <- read.csv(here(""data"", ""pre_feat_data.csv""))"
"0","#Make sure marathon, gender,subgroup, and supershoe are all factors (KB)"
"0","main_data$supershoe <- factor(main_data$supershoe)"
"0","main_data$marathon <- factor(main_data$marathon)"
"0","main_data$gender   <- factor(main_data$gender)"
"0","main_data$subgroup <- factor(main_data$subgroup)"
"0",""
"0","#split data into train and test"
"0","set.seed(123)"
"0",""
"0","train_index <- sample(1:nrow(main_data), size = 0.9 * nrow(main_data)) # use a 90/10 split"
"0",""
"0","train_data <- main_data[train_index, ]"
"0","test_data  <- main_data[-train_index, ]"
"0",""
"0","# Identify numeric predictors to scale (exclude outcome and identifiers)"
"0","numeric_vars <- train_data %>%"
"0","  select(where(is.numeric)) %>%"
"0","  select(-avg_chip_seconds, -year, -n) %>%"
"0","  names()"
"0",""
"0","# scale training data and save scaling parameters"
"0","train_scaled <- scale(train_data[numeric_vars])"
"0","train_data[paste0(""scaled_"", numeric_vars)] <- train_scaled"
"0",""
"0","train_center <- attr(train_scaled, ""scaled:center"")"
"0","train_scale  <- attr(train_scaled, ""scaled:scale"")"
"0",""
"0","# scale test data using training parameters"
"0","test_scaled <- scale(test_data[numeric_vars],"
"0","                     center = train_center,"
"0","                     scale  = train_scale)"
"0","test_data[paste0(""scaled_"", numeric_vars)] <- test_scaled"
"0",""
"0",""
"0","summary(train_data[paste0(""scaled_"", numeric_vars)])"
"1",""
"1"," scaled_avg_temp  "
"1"," scaled_precipitation"
"1"," scaled_dew_point "
"1"," scaled_wind_speed "
"1","
"
"1"," Min.   :-2.4665  "
"1"," Min.   :-0.2376     "
"1"," Min.   :-1.6105  "
"1"," Min.   :-1.57367  "
"1","
"
"1"," 1st Qu.:-0.6886  "
"1"," 1st Qu.:-0.2376     "
"1"," 1st Qu.:-0.7537  "
"1"," 1st Qu.:-0.57955  "
"1","
"
"1"," Median :-0.1931  "
"1"," Median :-0.2376     "
"1"," Median :-0.0240  "
"1"," Median :-0.08249  "
"1","
"
"1"," Mean   : 0.0000  "
"1"," Mean   : 0.0000     "
"1"," Mean   : 0.0000  "
"1"," Mean   : 0.00000  "
"1","
"
"1"," 3rd Qu.: 0.5735  "
"1"," 3rd Qu.:-0.2376     "
"1"," 3rd Qu.: 0.6771  "
"1"," 3rd Qu.: 0.41458  "
"1","
"
"1"," Max.   : 2.8256  "
"1"," Max.   : 6.1116     "
"1"," Max.   : 2.4515  "
"1"," Max.   : 3.89402  "
"1","
"
"1",""
"1"," scaled_visibility"
"1"," scaled_sea_level_pressure"
"1","   scaled_co      "
"1","
"
"1"," Min.   :-0.1146  "
"1"," Min.   :-2.06242         "
"1"," Min.   :-1.0106  "
"1","
"
"1"," 1st Qu.:-0.1146  "
"1"," 1st Qu.:-0.80425         "
"1"," 1st Qu.:-0.6693  "
"1","
"
"1"," Median :-0.1146  "
"1"," Median : 0.09045         "
"1"," Median :-0.4134  "
"1","
"
"1"," Mean   : 0.0000  "
"1"," Mean   : 0.00000         "
"1"," Mean   : 0.0000  "
"1","
"
"1"," 3rd Qu.:-0.1146  "
"1"," 3rd Qu.: 0.92924         "
"1"," 3rd Qu.: 0.2691  "
"1","
"
"1"," Max.   : 8.7115  "
"1"," Max.   : 1.82394         "
"1"," Max.   : 3.5964  "
"1","
"
"1",""
"1","  scaled_ozone    "
"1","  scaled_pm25     "
"1","   scaled_no2      "
"1","
"
"1"," Min.   :-1.3319  "
"1"," Min.   :-1.8827  "
"1"," Min.   :-2.41721  "
"1","
"
"1"," 1st Qu.:-0.7161  "
"1"," 1st Qu.:-0.6027  "
"1"," 1st Qu.:-0.78842  "
"1","
"
"1"," Median :-0.2849  "
"1"," Median :-0.2370  "
"1"," Median : 0.02597  "
"1","
"
"1"," Mean   : 0.0000  "
"1"," Mean   : 0.0000  "
"1"," Mean   : 0.00000  "
"1","
"
"1"," 3rd Qu.: 0.2694  "
"1"," 3rd Qu.: 0.4944  "
"1"," 3rd Qu.: 0.59605  "
"1","
"
"1"," Max.   : 3.5336  "
"1"," Max.   : 3.7858  "
"1"," Max.   : 2.30628  "
"1","
"
"1",""
"1"," scaled_temp_aqi_interaction"
"1"," scaled_avg_temp_gender_interaction"
"1","
"
"1"," Min.   :-1.2552            "
"1"," Min.   :-0.9842                   "
"1","
"
"1"," 1st Qu.:-0.6619            "
"1"," 1st Qu.:-0.9842                   "
"1","
"
"1"," Median :-0.2796            "
"1"," Median : 0.4232                   "
"1","
"
"1"," Mean   : 0.0000            "
"1"," Mean   : 0.0000                   "
"1","
"
"1"," 3rd Qu.: 0.1835            "
"1"," 3rd Qu.: 0.8932                   "
"1","
"
"1"," Max.   : 3.0146            "
"1"," Max.   : 1.9318                   "
"1","
"
"0","# Adding Binned features based off Decision Tree (ozone_bin and pm25_bin) (KB)"
"0",""
"0","# Training data "
"0","train_data$ozone_bin <- factor(ifelse(train_data$ozone >= 38, 1, 0), levels = c(0, 1))"
"0","train_data$pm25_bin  <- factor(ifelse(train_data$pm25 >= 54, 1, 0), levels = c(0, 1))"
"0",""
"0","# Test data using same thresholds"
"0","test_data$ozone_bin <- factor(ifelse(test_data$ozone >= 38, 1, 0), levels = c(0, 1))"
"0","test_data$pm25_bin  <- factor(ifelse(test_data$pm25 >= 54, 1, 0), levels = c(0, 1))"
"0",""
"0","# Remove scaled_ozone from training and test data - from LASSO results in initial model (KB)"
"0","train_data <- train_data[, !(names(train_data) %in% c(""scaled_ozone""))]"
"0","test_data  <- test_data[, !(names(test_data) %in% c(""scaled_ozone""))]"
"0",""
